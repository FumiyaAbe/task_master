<div class="mx-auto max-w-3xl px-4 py-6">
  <div class="card">
    <!-- タイトル + 操作 -->
    <div class="flex items-start justify-between gap-3">
      <h1 class="text-2xl font-bold"><%= @task.title %></h1>
      <% if user_signed_in? %>
        <div class="flex gap-2">
          <%= link_to "編集", edit_task_path(@task), class: "btn-main" %>
          <%= button_to "削除", task_path(@task),
                method: :delete,
                data: { confirm: "本当に削除しますか？" },
                class: "btn-ghost" %>
        </div>
      <% end %>
    </div>

    <!-- ステータス / 優先度 -->
    <div class="mt-3 space-x-2">
      <% if @task.status.present? %>
        <span class="badge <%= @task.status.to_s.downcase == 'done' ? 'badge-green' : 'badge-indigo' %>">
          状態: <%= @task.status %>
        </span>
      <% end %>

      <% if @task.priority.present? %>
        <% pr = @task.priority.to_s.downcase %>
        <% pr_class = case pr
                      when 'high','urgent' then 'badge-red'
                      when 'low'           then 'badge-gray'
                      else                       'badge-indigo'
                      end %>
        <span class="badge <%= pr_class %>">
          優先度: <%= @task.priority %>
        </span>
      <% end %>
    </div>

    <!-- 期限 -->
    <% if @task.due_at.present? %>
      <div class="card-meta mt-2">
        期限: <%= l(@task.due_at, format: :long) rescue @task.due_at.to_s %>
      </div>
    <% end %>

    <!-- 本文 -->
    <% if @task.body.present? %>
      <div class="mt-4 text-gray-700">
        <%= simple_format(@task.body) %>
      </div>
    <% end %>
  </div>

  <!-- 戻る -->
  <div class="mt-4">
    <%= link_to "タスク一覧に戻る", tasks_path, class: "btn-ghost" %>
  </div>
</div>
