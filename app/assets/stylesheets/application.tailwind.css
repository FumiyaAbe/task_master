/* ▼▼ Tailwind v4 の JIT に .erb 等を確実に読ませる ▼▼ */
@source "../../views/**/*.{erb,html}",
        "../../helpers/**/*.rb",
        "../../javascript/**/*.{js,ts}",
        "../../components/**/*.{erb,rb,html}",
        "./**/*.css";
/* ▲▲ ここまで必須 ▲▲ */

@import "tailwindcss";

/* ---- Tailwind v4: カスタムトークン ---- */
@theme {
  /* brand */
  --color-base:   #F9FAFB;
  --color-main:   #0F3A69;
  --color-accent: #2563EB;

  /* gray */
  --color-gray-100: #f3f4f6;
  --color-gray-200: #e5e7eb;
  --color-gray-300: #d1d5db;
  --color-gray-500: #6b7280;
  --color-gray-700: #374151;
  --color-gray-900: #111827;

  /* blue */
  --color-blue-50:  #eff6ff;
  --color-blue-100: #dbeafe;
  --color-blue-200: #bfdbfe;
  --color-blue-600: #2563eb;

  /* red */
  --color-red-50:  #fef2f2;
  --color-red-100: #fee2e2;
  --color-red-200: #fecaca;
  --color-red-600: #dc2626;

  /* spacing / size / radius / font / ring（最低限） */
  --spacing-2: 0.5rem;   /* 8px  */
  --spacing-3: 0.75rem;  /* 12px */
  --spacing-4: 1rem;     /* 16px */

  --size-4: 1rem;        /* 16px */

  --radius-xl: 0.75rem;
  --radius-2xl: 1rem;
  --radius-full: 9999px;

  --text-xs: 0.75rem;
  --text-sm: 0.875rem;
  --text-base: 1rem;

  --ring-2: 2px;
  --ring-offset-2: 2px;
}

/* === Base === */
@layer base {
  :root {
    --color-base:   #F9FAFB;
    --color-main:   #0F3A69;
    --color-accent: #2563EB;
  }

  body { @apply bg-base text-gray-900; }
}

/* === Components === */
@layer components {
  /* Buttons */
  .btn {
    @apply inline-flex items-center justify-center gap-2 rounded-xl px-3 py-2
           text-sm font-medium transition
           focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2
           disabled:opacity-50 disabled:cursor-not-allowed;
  }
  /* ※ .btn はベース。使用時は class="btn btn-main" のように併記 */
  .btn-main   { @apply bg-main   text-white hover:opacity-90; }
  .btn-accent { @apply bg-accent text-white hover:opacity-90; }
  .btn-ghost  { @apply border border-gray-300 text-gray-700 hover:bg-gray-50; }
  .btn-ghost.is-active { @apply bg-main text-white border-main hover:opacity-100; }

  .btn-main  > button { @apply bg-main   text-white hover:opacity-90; }
  .btn-accent> button { @apply bg-accent text-white hover:opacity-90; }
  .btn-ghost > button { @apply border border-gray-300 text-gray-700 hover:bg-gray-50; }
  .btn-ghost.is-active > button { @apply bg-main text-white border-main hover:opacity-100; }

  /* Cards */
  .card       { @apply rounded-2xl border bg-white p-4 shadow-sm; }
  .card-title { @apply text-base font-semibold; }
  .card-meta  { @apply text-xs text-gray-500; }

  /* Badges */
  .badge { @apply inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium; }
  /* ※ 使用時は class="badge badge-gray" のように base+variant を併記 */
  .badge-gray   { @apply bg-gray-100   text-gray-700; }
  .badge-green  { @apply bg-green-100  text-green-700; }
  .badge-red    { @apply bg-red-100    text-red-700; }
  .badge-indigo { @apply bg-indigo-100 text-indigo-700; }

  .page-head { @apply flex items-center justify-between gap-3; }

  /* Forms */
  .input    { @apply w-full rounded-xl border px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500; }
  .textarea { @apply w-full rounded-xl border px-3 py-2 text-sm min-h-[120px] focus:outline-none focus:ring-2 focus:ring-indigo-500; }
  .checkbox { @apply h-4 w-4 rounded border; }
  .form-label { @apply block text-sm font-medium text-gray-700; }
  .form-hint  { @apply mt-1 text-xs text-gray-500; }
  .form-error { @apply mt-1 text-xs text-red-600; }

  .input-error { @apply ring-1 ring-red-500 border-red-500 bg-red-50; }

  /* Rails wrappers（@applyでカスタムを再適用しない） */
  .field_with_errors > input,
  .field_with_errors > textarea,
  .field_with_errors > select { @apply ring-1 ring-red-500 border-red-500 bg-red-50; }

  .simple_form div.input.error input,
  .simple_form div.input.error textarea,
  .simple_form div.input.error select { @apply ring-1 ring-red-500 border-red-500 bg-red-50; }

  .simple_form div.input.error label,
  .input.error .form-label { @apply text-red-700; }

  .invalid-feedback { @apply mt-1 text-xs text-red-600; }

  .simple_form .error_notification {
    @apply mx-auto max-w-3xl mb-3 rounded-xl px-4 py-3 text-sm
           border border-red-200 bg-red-50 text-red-700;
  }

  .simple_form .error { @apply text-red-600 text-sm mt-1; }

  .simple_form .has-error input,
  .simple_form .has-error textarea,
  .simple_form .has-error select { @apply ring-1 ring-red-500 border-red-500 bg-red-50; }
  .simple_form .has-error label { @apply text-red-700; }

  span.error { @apply mt-1 text-xs text-red-600; }

  /* Flash */
  .flash-base { @apply mx-auto max-w-3xl mb-3 rounded-xl px-4 py-2 text-sm; }
  /* ※ 使用時は class="flash-base flash-notice" のように base+variant を併記 */
  .flash-notice { @apply bg-green-50 text-green-800 border border-green-200; }
  .flash-alert  { @apply bg-red-50   text-red-800   border border-red-200; }
  .flash-info   { @apply bg-blue-50  text-blue-800  border border-blue-200; }

  /* Calendar grid */
  .calendar-week { @apply grid grid-cols-7 gap-2 text-sm mb-2; }
  .calendar-grid { @apply grid grid-cols-7 gap-2; }

  /* Site header */
  .site-header {
    background-color: var(--color-main, #0F3A69);
    color: #fff;
    @apply bg-main text-white;
  }
  .site-header a { @apply text-white/90 hover:text-white; }
}

/* === Utilities（独自） === */
@layer utilities {
  .bg-main     { background-color: var(--color-main); }
  .text-main   { color:            var(--color-main); }
  .border-main { border-color:     var(--color-main); }
  .tabular-nums { font-variant-numeric: tabular-nums; }
}

/* === Calendar day "chips"（Tailwind未生成時のフォールバック込み） === */
@layer utilities {
  /* 真円サイズ（w=h）。mdで少し拡大 */
  .chip-circle { width: 2.25rem; height: 2.25rem; border-radius: 9999px; }
  @media (min-width: 768px) {
    .chip-circle { width: 2.5rem; height: 2.5rem; }
  }

  /* レイアウト／共通 */
  .chip-base {
    display: inline-flex; align-items: center; justify-content: center;
    font-variant-numeric: tabular-nums; font-weight: 500; font-size: 0.875rem; line-height: 1;
    cursor: pointer; user-select: none; transition: background-color .15s ease;
    border-width: 1px; outline: none;
  }
  .chip-focus { box-shadow: 0 0 0 2px rgb(99 102 241 / .8); } /* indigo-500 相当 */

  /* 平日/当月 */
  .chip-wd      { color:#374151; background:#f3f4f6; border-color:#d1d5db; }
  .chip-wd:hover{ background:#e5e7eb; }

  /* 当月外 */
  .chip-out      { color:#9ca3af; background:#f9fafb; border-color:#e5e7eb; }
  .chip-out:hover{ background:#f3f4f6; }

  /* 日曜 */
  .chip-sun      { color:#b91c1c; background:#fee2e2; border-color:#fecaca; }
  .chip-sun:hover{ background:#fecaca; }

  /* 土曜 */
  .chip-sat      { color:#1d4ed8; background:#dbeafe; border-color:#bfdbfe; }
  .chip-sat:hover{ background:#bfdbfe; }
}
